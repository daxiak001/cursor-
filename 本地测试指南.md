# 本地测试指南

## 🧪 本地测试步骤

### 1. 安装依赖

```bash
# 安装Python依赖
pip install -r requirements.txt
```

### 2. 配置环境变量（可选）

创建 `.env` 文件：

```bash
CLAUDE_API_KEY=your_api_key_here
PORT=8000
```

### 3. 启动本地服务

```bash
# 方式一：直接运行
uvicorn api.main:app --reload --port 8000

# 方式二：使用Python
python -m uvicorn api.main:app --reload --port 8000
```

### 4. 测试API

打开新的终端窗口，运行：

```bash
# Windows
test_api.bat

# Linux/Mac
python test_api.py
```

## 🔍 手动测试

### 测试健康检查

```bash
curl http://localhost:8000/health
```

预期响应：
```json
{
  "status": "healthy",
  "service": "xiaoliu-ai",
  "timestamp": "2024-..."
}
```

### 测试聊天接口

```bash
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d "{\"message\": \"你好小柳\", \"user_id\": \"test\"}"
```

预期响应：
```json
{
  "response": "是的柳哥，我是小柳！已成功接入，随时为您服务！",
  "status": "success",
  "timestamp": "2024-..."
}
```

### 测试功能列表

```bash
curl http://localhost:8000/features
```

## ⚠️ 注意事项

### 本地测试不需要Claude API密钥

- 快捷指令测试不需要API密钥
- 只有调用通用对话功能才需要
- 部署到生产环境时必须配置

### 端口占用

如果8000端口被占用：

```bash
# 更换端口
uvicorn api.main:app --port 8001
```

### 防火墙问题

确保防火墙允许访问8000端口

## 📊 测试结果说明

测试脚本会自动：
1. 检测可用的API（本地或云端）
2. 运行所有测试用例
3. 显示详细结果
4. 生成测试报告

全部通过表示API运行正常，可以部署到生产环境！

